/* empty css             */import{_ as w,r as d,w as x,v as D,o as n,c as l,a as t,b as c,d as m,F as I,e as T,f as S,g as _,t as p,h as u,i as b}from"./index-7b70d034.js";const C={components:{},data(){return{isDarkTheme:!1,contentDiv:[],textarea:"",right:!0,show:!1,flag:!0,closeChat:this.close,sessionId:"",template:[],template_id:""}},async created(){let s=localStorage.getItem("dark_theme");this.isDarkTheme=s=="dark";let e=localStorage.getItem("session_id");if(e){this.sessionId=e;let r=localStorage.getItem(this.sessionId);r&&(this.contentDiv=JSON.parse(r))}this.scrollToBottom();const i=await fetch("/api/ai/templates",{method:"GET",headers:{"Content-Type":"application/json"}});this.template=await i.json(),this.template_id=this.template[0].value},watch:{isDarkTheme:{handler(s,e){e!=null&&(localStorage.setItem("dark_theme",this.isDarkTheme?"dark":"light"),this.isDarkTheme?(document.body.classList.remove("light-theme"),document.body.classList.add("dark-theme")):(document.body.classList.remove("dark-theme"),document.body.classList.add("light-theme")))},deep:!0,immediate:!0}},async mounted(){},updated(){this.scrollToBottom()},methods:{async fetchTemplate(){console.log(this.template_id);const s=await fetch(`/api/ai/template/${this.template_id}`,{method:"GET",headers:{"Content-Type":"application/json"}});this.textarea=await s.json()},scrollToBottom(){this.$nextTick(()=>{let s=this.$el.querySelector(".talk-content");s.scrollTop=s.scrollHeight})},clear(){this.sessionId&&(localStorage.removeItem(this.sessionId),localStorage.removeItem("session_id")),this.contentDiv=[],this.sessionId=""},async submit(){let s=this.textarea;if(s.trim().length==0)return;this.textarea="";let e=!1;this.contentDiv.length==0&&(e=!0);let i={name:"你",url:"",showAvartar:e,content:s,right:!0,time:new Date().toLocaleTimeString()};this.contentDiv.push(i),this.save();let r=await this.ask(s),o={name:"AI",url:"",showAvartar:e,content:r,right:!1,time:new Date().toLocaleTimeString()};this.contentDiv.push(o),this.save()},save(){this.sessionId&&localStorage.setItem(this.sessionId,JSON.stringify(this.contentDiv))},async ask(s){let i=await(await fetch("/api/ai/ask",{method:"POST",body:JSON.stringify({prompt:s,session_id:this.sessionId}),headers:{"Content-Type":"application/json"}})).json();return i.session_id&&(!this.sessionId||!this.sessionId.length)&&(this.sessionId=i.session_id,this.saveSession(this.sessionId)),i.message},saveSession(s){localStorage.setItem("session_id",s)},exit(){this.$emit("close",this.flag)}}},B={class:"talk"},A={class:"talk-header"},N=t("div",{class:"talk-message-title"},"AI对话",-1),j={class:"talk-message-clear"},L={class:"talk-content"},z={key:0},E={key:0,style:{display:"flex","justify-content":"flex-end","align-items":"center"}},F={class:"name_right"},V={style:{"font-size":"0.5rem",color:"#9b9b9b"}},O={class:"url_right"},J={class:"content_right"},U={class:"content"},G={key:1},K={key:0,style:{display:"flex","align-items":"center"}},q={class:"url_left"},H={class:"name_left"},M={style:{"font-size":"0.5rem",color:"#9b9b9b"}},P={class:"content_left"},Q={class:"content"},R={class:"talk-message"},W={class:"talk-message-content"},X={class:"talk-message-send"};function Y(s,e,i,r,o,h){const f=d("a-select"),k=d("a-switch"),v=d("a-button"),g=d("a-avatar"),y=d("a-textarea");return x((n(),l("div",B,[t("div",A,[N,c(f,{class:"talk-role",dropdownClassName:"talk-role",value:o.template_id,"onUpdate:value":e[0]||(e[0]=a=>o.template_id=a),options:o.template,onChange:h.fetchTemplate},null,8,["value","options","onChange"]),t("div",j,[c(k,{"checked-children":"暗","un-checked-children":"亮",checked:o.isDarkTheme,"onUpdate:checked":e[1]||(e[1]=a=>o.isDarkTheme=a)},null,8,["checked"]),c(v,{type:"text",onClick:h.clear},{default:m(()=>[_("新会话")]),_:1},8,["onClick"])])]),t("div",L,[(n(!0),l(I,null,T(o.contentDiv,a=>(n(),l("div",null,[a.right?(n(),l("div",z,[a.showAvartar?(n(),l("div",E,[t("div",F,[t("p",V,p(a.time),1)]),t("div",O,[c(g,{shape:"circle",size:30},{default:m(()=>[_("你")]),_:1})])])):u("",!0),t("div",J,[t("pre",U,p(a.content),1)])])):u("",!0),a.right?u("",!0):(n(),l("div",G,[a.showAvartar?(n(),l("div",K,[t("div",q,[c(g,{shape:"circle",size:30,style:{backgroundColor:"#f56a00",verticalAlign:"middle"}},{default:m(()=>[_("AI")]),_:1})]),t("div",H,[t("p",M,p(a.time),1)])])):u("",!0),t("div",P,[t("pre",Q,p(a.content),1)])]))]))),256))]),t("div",R,[t("div",W,[c(y,{class:"input-area",ref:"textarea",id:"textinput",value:o.textarea,"onUpdate:value":e[2]||(e[2]=a=>o.textarea=a),autoSize:"",rows:1,onKeydown:e[3]||(e[3]=S(b(a=>h.submit(),["exact","prevent"]),["enter"]))},null,8,["value"])]),t("div",X,[c(v,{type:"text",onClick:h.submit},{default:m(()=>[_("发送")]),_:1},8,["onClick"])])])],512)),[[D,o.flag]])}const ee=w(C,[["render",Y]]);export{ee as default};
