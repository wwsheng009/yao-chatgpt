/* empty css             */import{_ as y,r as _,w as x,v as k,o as l,c,a as t,F as b,e as w,b as h,f as D,i as T,d as u,t as d,g as p,h as m}from"./index-7b70d034.js";const S={components:{},data(){return{contentDiv:[],textarea:"",right:!0,show:!1,flag:!0,closeChat:this.close,conversation:[]}},created(){},mounted(){this.scrollToBottom()},updated(){this.scrollToBottom()},methods:{scrollToBottom(){this.$nextTick(()=>{let e=this.$el.querySelector(".talk-content");e.scrollTop=e.scrollHeight})},sendInfo(){alert("aaa")},isShow(){},iptFocus(){},async submit(){let e=this.textarea;this.textarea="";let o=this.$el.querySelector("#textinput");o.style.height="";let n={name:"你",url:"",content:e,right:!0,time:new Date().toLocaleTimeString()};this.contentDiv.push(n);let s={name:"AI",url:"",content:await this.ask(e),right:!1,time:new Date().toLocaleTimeString()};this.contentDiv.push(s)},async ask(e){this.conversation.push({u:e});let n=await(await fetch("/api/ai/ask2",{method:"POST",body:JSON.stringify({prompt:e,conversation:this.conversation}),headers:{"Content-Type":"application/json"}})).json();return this.conversation.push({ai:n}),this.checkLenAndDelete(),n},checkLenAndDelete(){var n,r;let e=0,o=0;for(let s=this.conversation.length-1;s>=0;s--){const a=this.conversation[s];if(a.u?e+=(n=a.u)==null?void 0:n.length:a.ai&&(e+=(r=a.ai)==null?void 0:r.length),e>10240){o=s;break}}console.log(o),console.log(this.conversation),this.conversation.shift(),o--},exit(){this.$emit("close",this.flag)}}},B={class:"talk"},C=t("div",{class:"talk-header"},[t("h2",null,"智能AI对话")],-1),A={class:"talk-content"},F={style:{"margin-top":"20px"}},z={key:0},L={style:{display:"flex","justify-content":"flex-end","align-items":"center"}},N={class:"name_right"},I={style:{"font-size":"0.5rem",color:"#9b9b9b"}},V={class:"url_right"},j={class:"content_right"},K={key:1},H={style:{display:"flex","align-items":"center"}},O={class:"url_left"},$={class:"name_left"},q={style:{"font-size":"0.5rem",color:"#9b9b9b"}},E={class:"content_left"},J={class:"talk-message"},M={class:"talk-message-content"},P={class:"talk-message-send"};function U(e,o,n,r,s,a){const v=_("a-avatar"),f=_("a-textarea"),g=_("a-button");return x((l(),c("div",B,[C,t("div",A,[(l(!0),c(b,null,w(s.contentDiv,i=>(l(),c("div",F,[i.right?(l(),c("div",z,[t("div",L,[t("div",N,[t("p",I,d(i.time),1)]),t("div",V,[h(v,{shape:"circle",size:30},{default:u(()=>[p("你")]),_:1})])]),t("div",j,[t("pre",null,d(i.content),1)])])):m("",!0),i.right?m("",!0):(l(),c("div",K,[t("div",H,[t("div",O,[h(v,{shape:"circle",size:30,style:{backgroundColor:"#f56a00",verticalAlign:"middle"}},{default:u(()=>[p("AI")]),_:1})]),t("div",$,[t("p",q,d(i.time),1)])]),t("div",E,[t("pre",null,d(i.content),1)])]))]))),256))]),t("div",J,[t("div",M,[h(f,{id:"textinput",style:{"overflow-y":"hidden"},value:s.textarea,"onUpdate:value":o[0]||(o[0]=i=>s.textarea=i),resize:"none",type:"textarea",rows:1,onKeypress:D(T(a.submit,["prevent"]),["enter"]),oninput:'this.style.height = "";this.style.height = this.scrollHeight + "px"'},null,8,["value","onKeypress"])]),t("div",P,[h(g,{type:"text",onClick:a.submit},{default:u(()=>[p("发送")]),_:1},8,["onClick"])])])],512)),[[k,s.flag]])}const R=y(S,[["render",U]]);export{R as default};
